http://stackoverflow.com/questions/27724106/group-by-and-conditionally-count
